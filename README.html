
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Watch Application System in Python &#8212; WASP-OS  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="WASP Internals" href="wasp.html" />
    <link rel="prev" title="Welcome to WASP-OS’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="watch-application-system-in-python">
<h1>Watch Application System in Python<a class="headerlink" href="#watch-application-system-in-python" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Currently in its infancy wasp-os provides nothing more than a simple
digital clock application for <a class="reference external" href="https://www.pine64.org/pinetime/">PineTime</a>
together with access to the MicroPython REPL for interactive testing and
tweaking. However it keeps time well and has enough power saving
functions implemented that it can survive for well over 24 hours between
charges so even at this early stage it is functional as a wearable
timepiece.</p>
<p>WASP includes a robust bootloader based on the Adafruit NRF52
Bootloader. It has been extended to make it robust for development on
form-factor devices without a reset button, power switch, SWD debugger
or UART. This allows us to confidently develop on sealed devices relying
only on BLE for updates.</p>
<p><img alt="_images/clock_app.jpg" src="_images/clock_app.jpg" />wasp-os digital clock app running on PineTime</p>
</div>
<div class="section" id="video">
<h2>Video<a class="headerlink" href="#video" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://www.youtube.com/watch?v=W0CmqOnl4jk"><img alt="https://img.youtube.com/vi/W0CmqOnl4jk/1.jpg" src="https://img.youtube.com/vi/W0CmqOnl4jk/1.jpg" />WASP bootloader and MicroPython running on Pine64 PineTime</a></p>
</div>
<div class="section" id="building-from-a-git-clone">
<h2>Building from a git clone<a class="headerlink" href="#building-from-a-git-clone" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pip3 install --user click serial pyserial
make submodules
make softdevice
make -j `nproc` BOARD=pinetime all
</pre></div>
</div>
<p>Note: <em>You will need a toolchain for the Arm Cortex-M4. wasp-os is developed and tested using the <a class="reference external" href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm">GNU-RM toolchain</a> (9-2019-q4) from Arm.</em></p>
<p>Note #2: <em>There are known problems with toolchains older than gcc-7.3 due to problems with link-time-optimization (which is enabled by default)</em></p>
</div>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h2>
<p>Note: <em>If you have a new PineTime then it will have been delivered with
flash protection enabled. You must disable the flash protection before
trying to program it.</em></p>
<ul class="simple">
<li><p>Use an SWD programmer to install <code class="docutils literal notranslate"><span class="pre">bootloader.hex</span></code> to the PineTime.
This file is an Intel HEX file containing both the bootloader and
the Nordic SoftDevice. Be careful to disconnect cleanly from the
debug software since just pulling out the SWD cable will mean the
nRF52 will still believe it is being debugged.</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">micropython.zip</span></code> to your Android device and download nRF Connect
for Android if you do not already have it.</p></li>
<li><p>In nRF Connect, choose settings and reduce the DFU packet count from
10 to 4.</p></li>
<li><p>Connect to PineDFU using nRFConnect, click the DFU button and send
<code class="docutils literal notranslate"><span class="pre">micropython.zip</span></code> to the device.</p></li>
</ul>
<p>At the end of this process your watch will show the time (12:00) and a
battery meter. When the watch goes into power saving mode you can use
the side button to wake it again.</p>
<p>At this point you will also be able to use the Nordic UART Service to
access the MicroPython REPL, although currently you must send ^C to
interrupt the program that updates the watch display.</p>
<p>Just for fun try:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">^</span><span class="n">C</span>
<span class="kn">import</span> <span class="nn">demo</span>
<span class="n">demo</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c1"># After watching the demo for a bit...</span>
<span class="o">^</span><span class="n">C</span>
<span class="n">wasp</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">watch</span><span class="p">)</span>
<span class="n">wasp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>To set the time and restart the main application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">^</span><span class="n">C</span>
<span class="n">watch</span><span class="o">.</span><span class="n">rtc</span><span class="o">.</span><span class="n">set_time</span><span class="p">((</span><span class="n">hh</span><span class="p">,</span> <span class="n">mm</span><span class="p">,</span> <span class="n">ss</span><span class="p">))</span>
<span class="n">wasp</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<p>As mentioned above there are many drivers and features still to be
developed, see the <a class="reference internal" href="TODO.html"><span class="doc">TODO list</span></a> for current status.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">WASP-OS</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Watch Application System in Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#video">Video</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-from-a-git-clone">Building from a git clone</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing">Installing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="wasp.html">WASP Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="TODO.html">Roadmap</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to WASP-OS’s documentation!</a></li>
      <li>Next: <a href="wasp.html" title="next chapter">WASP Internals</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Daniel Thompson.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/README.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>